# FBGsensor - 光纤光栅解调仪上位机监测软件

本软件用来在上位机获取光纤光栅解调仪数据，得出中心波长并计算被测量的值  

软件作者：高旭

## 使用方法

> 配合北京为韵公司的光纤光栅解调仪使用  
> 硬件：需要连接好仪器usb和电源， 保证光纤光栅连接牢固， 开启仪器电源开关

1. 安装硬件驱动`CDM21216_Setup.exe`, 甚至可在网上搜索到
2. 查看COM号，可在系统**设备管理器 - 端口**中查看
3. 安装FBGsensor软件
4. 选择对应的端口号，**打开设备**
5. 点击对应按钮实现相应功能
6. 测量结束时，**关闭设备**，退出软件

## 软件功能(勾选为已实现)

- [x] 打开设备
- [x] 设置及获取设备参数
- [x] 获取光谱数据
- [x] 光谱数据显示（缩放功能及数据指针）
- [x] 光谱数据存储为csv文件
- [x] 光谱数据处理模块（重心法处理）
- [x] 显示并记录波长值
- [x] 计算并显示被测量
- [x] 显示可检测传感器
- [x] 自动检测传感器连接状况
- [ ] 显示波长及被测量变化情况
- [ ] 记录被测量变化情况

## 注意事项

- 开始扫描后约7秒后，仪器才能到达稳定状态，此时数据才可用
- 温度采用二次多项式标定，精度在±1度

## 传感器信息设置方法

程序会读取`"FBGconfig.ini"`文件，该文件保存所有可识别的传感器参数信息，需要手动写入，其中每一项参数意义为

- **type**：传感器类型，0-温度，1-压力，2-湿度
- **wavrangestart**：起始特征波长，程序将从该波长开始检测是否有该传感器的峰值，需要与其他传感器波段保持互斥，单位pm
- **wavrangeend**：终止特征波长，程序将到该波长停止检测是否有该传感器的峰值，需要与其他传感器波段保持互斥，单位pm
- **mu0**：自变量中心化参数-波长均值，计算公式为$\hat{x} = (x - \mu_0) /\mu_1$,
- **mu1**：自变量中心化参数-波长标准差
- **a0-a4**:标定参数，最高支持三次多项式函数，计算公式为$y=a_0+a_1\hat{x}+a_2\hat{x}^2+a_3\hat{x}^3$
- **size**:传感器数目，在增加或减少传感器时需要更改
